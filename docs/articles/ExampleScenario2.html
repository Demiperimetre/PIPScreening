<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ExampleScenario2 â€¢ PIPScreening</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ExampleScenario2">
<meta property="og:description" content="PIPScreening">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PIPScreening</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ExampleScenario.html">ExampleScenario</a>
    </li>
    <li>
      <a href="../articles/ExampleScenario2.html">ExampleScenario2</a>
    </li>
    <li>
      <a href="../articles/ExampleScenarioCalwithRep.html">Integrated approach vs. two-step approaches</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ExampleScenario2_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ExampleScenario2</h1>
            
      
      
      <div class="hidden name"><code>ExampleScenario2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PIPScreening</span><span class="op">)</span></code></pre></div>
<div id="scenario-setting" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-setting" class="anchor"></a>Scenario setting</h2>
<p>True physical model is <span class="math display">\[\zeta_i(x_1,x_2)=x_1+x_2,.\]</span></p>
<p>The field data are for <span class="math inline">\(i=1,\ldots,N\)</span> : <span class="math display">\[y_i=\zeta(\mathbf{x_i})+\epsilon_i\,.\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\overset{iid}{\sim}\mathcal{N}(0,\sigma^2_\epsilon)\)</span>.</p>
<p>Our computer model / simulator is <span class="math display">\[f(\mathbf{x},{\theta})= \theta x_1+(1-\theta)x_2\,.\]</span> The parameter <span class="math inline">\({\theta}\)</span> is a model parameter, it may be fixed or be to calibrate. This parameter tunes which of the input variables <span class="math inline">\(x_1\)</span> or <span class="math inline">\(x_2\)</span> is taken into account with the constraint that they cannot be both active.</p>
</div>
<div id="data-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-simulation" class="anchor"></a>Data simulation</h2>
<p>Field data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span><span class="op">&lt;-</span><span class="fl">50</span>
<span class="va">theta</span><span class="op">&lt;-</span><span class="fl">.5</span> <span class="co"># choice of the theta (here same size as x)</span>
<span class="va">sd</span><span class="op">&lt;-</span><span class="fl">0.05</span>
<span class="va">scalefactor</span> <span class="op">=</span> <span class="fl">10</span>
<span class="co"># x1 &lt;- seq(0,1,length.out=N)</span>
<span class="co"># x2 &lt;- seq(0,1,length.out=N)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">simGal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">scalefactor</span><span class="op">}</span> 
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simGal.html">simGal</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># physical system</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">0</span>,<span class="va">sd</span><span class="op">)</span> <span class="co"># field exp by adding noise</span></code></pre></div>
<p>Preparing the data for running the MCMC run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simulator</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">theta</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">theta</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">scalefactor</span><span class="op">}</span><span class="co"># computer model (si on fait *2 en plus c'est identifiable et pour theta=.5 c'est le vrai modele)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">simulator</span><span class="op">(</span><span class="va">x</span>, <span class="fl">.5</span><span class="op">)</span> <span class="co"># output of computer model</span>
<span class="va">xnorm</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="va">min</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="va">min</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co"># normalization</span>
<span class="va">Yexp</span> <span class="op">&lt;-</span> <span class="va">y</span>; <span class="va">Xexpnorm</span> <span class="op">&lt;-</span> <span class="va">xnorm</span>; <span class="va">Xexp</span> <span class="op">&lt;-</span> <span class="va">x</span>;  <span class="va">Rexp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">mod</span><span class="op">)</span> </code></pre></div>
</div>
<div id="posterior-sampling-with-or-without-calibration" class="section level2">
<h2 class="hasAnchor">
<a href="#posterior-sampling-with-or-without-calibration" class="anchor"></a>Posterior sampling with or without calibration</h2>
<p>Without calibration (<span class="math inline">\(\boldsymbol{\theta}\)</span> being fixed to its true value)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calibration1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>computermodel<span class="op">=</span><span class="va">simulator</span>,Yexp<span class="op">=</span><span class="va">Yexp</span>,Xexp<span class="op">=</span><span class="va">Xexp</span>,<span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tdistFULL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tensordist.html">tensordist</a></span><span class="op">(</span><span class="va">xnorm</span><span class="op">)</span>
<span class="va">pgamma</span> <span class="op">&lt;-</span>  <span class="fl">2</span>
<span class="va">parwalk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="va">pgamma</span><span class="op">)</span>,<span class="fl">.1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span>
<span class="va">parwalkinit</span>  <span class="op">&lt;-</span>  <span class="va">parwalk</span>
<span class="va">init</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">pgamma</span><span class="op">)</span>,<span class="fl">.004</span>,<span class="fl">.2</span><span class="op">)</span>
<span class="va">parprior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">pgamma</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">.02</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">nMWG</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="va">nMet</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">resmcmc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="../reference/MCMC.html">MCMC</a></span><span class="op">(</span><span class="va">nMWG</span>,<span class="va">nMet</span>,<span class="va">parwalkinit</span>,<span class="va">init</span>,<span class="va">Rexp</span>,<span class="va">tdistFULL</span>,<span class="fl">1.9</span>,<span class="va">parprior</span>,<span class="cn">TRUE</span>,<span class="va">calibration1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>With calibration, we just changed some options to run this version such as the <code>calibration2</code> list which indicates that calibration should be done, the <code>init2</code> vector which gives the initial value for all the parameters (now it includes the <span class="math inline">\(\theta\)</span>s) and the <code>parwalkinit2</code> which gives the parameter for the random walk.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ptheta</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">calibration2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>computermodel<span class="op">=</span><span class="va">simulator</span>,Yexp<span class="op">=</span><span class="va">Yexp</span>,Xexp<span class="op">=</span><span class="va">Xexp</span>,<span class="cn">TRUE</span><span class="op">)</span>
<span class="va">parwalkinit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">parwalk</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="va">ptheta</span><span class="op">)</span><span class="op">)</span>
<span class="va">init2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">pgamma</span><span class="op">)</span>,<span class="fl">.004</span>,<span class="fl">.2</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="va">ptheta</span><span class="op">)</span><span class="op">)</span>
<span class="va">resmcmccal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC.html">MCMC</a></span><span class="op">(</span><span class="va">nMWG</span>,<span class="va">nMet</span>,<span class="va">parwalkinit2</span>,<span class="va">init2</span>,<span class="va">Rexp</span>,<span class="va">tdistFULL</span>,<span class="fl">1.9</span>,<span class="va">parprior</span>,<span class="cn">TRUE</span>,<span class="va">calibration2</span><span class="op">)</span></code></pre></div>
<p>The sampling is done with a Metropolis within Gibbs algorithm and then with a Metropolis algorithm. From the MwG algorithm, a covariance matrix is derived for the random walk in the upcoming Metropolis algorithm. Some adaptations are performed to set the exploration step. Note the number of iterations are really low in this vignette to limit its compilation time.</p>
</div>
<div id="computation-of-probabilites-of-activeness" class="section level2">
<h2 class="hasAnchor">
<a href="#computation-of-probabilites-of-activeness" class="anchor"></a>Computation of probabilites of activeness</h2>
<p>First computed from the posterior sampling without calibration and then computed from the posterior sampling which deals with calibration. We obtain then two vectors of probabilities which give for each variable the probability that a variable is active in the discrepancy. Here we expect that the fist variable (because of the power 2 in the physical system) and the second variable (because of the mismatch between the physical system and the computer model) to be active.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thinning</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nMet</span>,<span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="../reference/computeProbActive.html">computeProbActive</a></span><span class="op">(</span><span class="va">resmcmc</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="va">thinning</span>,<span class="fl">1</span><span class="op">:</span><span class="va">pgamma</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.05175037 0.05903950</span>
<span class="fu"><a href="../reference/computeProbActive.html">computeProbActive</a></span><span class="op">(</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="va">thinning</span>,<span class="fl">1</span><span class="op">:</span><span class="va">pgamma</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.04056581 0.60455040</span></code></pre></div>
<p>posterior sans calibration</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resmcmc</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">AccepRate</span>
<span class="co">#&gt; [1] 0.4571</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmc</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmc</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<p>posterior en calibration</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">AccepRate</span>
<span class="co">#&gt; [1] 0.3805</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>,<span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">vlogpost</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-3-5.png" width="700"></p>
</div>
<div id="two-step-discrepancy-screening" class="section level2">
<h2 class="hasAnchor">
<a href="#two-step-discrepancy-screening" class="anchor"></a>two-step discrepancy screening</h2>
<p>We estimate the parameter <span class="math inline">\(\theta\)</span> by the median of the posterior distribution</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thetamed</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">thetamed</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9808601</span>
<span class="va">modthetamed</span> <span class="op">&lt;-</span> <span class="fu">simulator</span><span class="op">(</span><span class="va">x</span>, <span class="va">thetamed</span><span class="op">)</span>
<span class="va">Rexp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">modthetamed</span><span class="op">)</span> 
<span class="va">resmcmcthetamed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="../reference/MCMC.html">MCMC</a></span><span class="op">(</span><span class="va">nMWG</span>,<span class="va">nMet</span>,<span class="va">parwalkinit</span>,<span class="va">init</span>,<span class="va">Rexp</span>,<span class="va">tdistFULL</span>,<span class="fl">1.9</span>,<span class="va">parprior</span>,<span class="cn">TRUE</span>,<span class="va">calibration1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resmcmcthetamed</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">AccepRate</span>
<span class="co">#&gt; [1] 0.4358</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmcthetamed</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmcthetamed</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>We estimate the parameter <span class="math inline">\(\theta\)</span> by the mean of the posterior distribution</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thetamean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmccal</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">thetamean</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.8980382</span>
<span class="va">modthetamean</span> <span class="op">&lt;-</span> <span class="fu">simulator</span><span class="op">(</span><span class="va">x</span>, <span class="va">thetamean</span><span class="op">)</span>
<span class="va">Rexp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">modthetamean</span><span class="op">)</span> 
<span class="va">resmcmcthetamean</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="../reference/MCMC.html">MCMC</a></span><span class="op">(</span><span class="va">nMWG</span>,<span class="va">nMet</span>,<span class="va">parwalkinit</span>,<span class="va">init</span>,<span class="va">Rexp</span>,<span class="va">tdistFULL</span>,<span class="fl">1.9</span>,<span class="va">parprior</span>,<span class="cn">TRUE</span>,<span class="va">calibration1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resmcmcthetamean</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">AccepRate</span>
<span class="co">#&gt; [1] 0.4482</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmcthetamean</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">resmcmcthetamean</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="ExampleScenario2_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>For both cases, we compte the probabilities of activness:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/computeProbActive.html">computeProbActive</a></span><span class="op">(</span><span class="va">resmcmcthetamed</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="va">thinning</span>,<span class="fl">1</span><span class="op">:</span><span class="va">pgamma</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.01079396 0.71888131</span>
<span class="fu"><a href="../reference/computeProbActive.html">computeProbActive</a></span><span class="op">(</span><span class="va">resmcmcthetamean</span><span class="op">$</span><span class="va">MH</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="va">thinning</span>,<span class="fl">1</span><span class="op">:</span><span class="va">pgamma</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.01372718 0.47972961</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Pierre Barbillon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
